# Book Discount API

## Описание 

Это задача для лайвкодинга, суть которой заклучается в работе с бизнес правилами. 

Задача: необходимо дописать файл ./internal/service/discount.go таким образом, чтобы выполнялись
следующие бизнес-правила:

1. Клиент еще не соверщаш покупку и берет от двух до пяти книг - скидка 20% на весь счет
2. Клиент уже совершал покупки в магазине, берет от 2 до 5 книг - скидка 10%
3. Клиент уже совершал покупки в магазине, берет от 6 до 10 книг - скидка 5%
4. Клиент уже совершал покупки в магазине, берет свяше 10 книг - скидка 2%
5. Если сегодня пятница - всем скидка 5% не зависимо от объема корзины или типа клиента
6. Если у клиента больше 5 экземляров одной книги действует, скидка в 40% на каждую вторую книгу
этой серии (условно есть в корзине 6 Гарри Поттер и Кубок огня, то каждая вторая такая книга получает скидку 40%).
Остальные правила перестают распространяться на эти книги и считаются для книг, не попадающих под это правило

Так же бизнес-логика должна быть покрыта тестами.

## Структура проекта

Точка инициализации проекта - ./cmd/api/main.go

Хендлер - ./internal/handler/discount_handler.go
Логика - ./internal/service/discount.go
Доменные сущности - ./internal/domain/models.go

### Типы клиентов 

| Тип клиента     | Значение | Описание                                | 
|-----------------|----------|-----------------------------------------|
| CustomerTypeOld | old      | Клиент, который уже совершал покупки    |
| CustomerTypeNew | new      | Клиент, который еще не совершал покупки |

### API

#### Расчет скидки 

URL: [POST] /api/v1/discount/calculate

Тело запроса: 
```json
{
  "customer_id": "1f14-34a1-1109-f14321",
  "customer_type": "new",
  "cash_register_id": "12",
  "books": [
    {"id": "1", "price": 12.99},
    {"id": "1", "price": 12.99},
    {"id": "69", "price": 5.00}
  ]
}
```

Тело ответа: 
```json
{
  "original_amount": 30.98,
  "discount_percent": 0.2,
  "discount_amount": 6.19,
  "final_amount": 24.78
}
```